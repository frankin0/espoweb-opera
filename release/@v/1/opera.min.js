/*
 * Opera vbuild 1.3-beta
 * Copyright 2022 The Opera Espoweb Authors
 * Licensed under MIT (https://github.com/frankin0/espoweb-opera/LICENSE)
 */

var Mask={option:[],init:function(t,e){const o=this.extend({dashItms:["/","-"," ","[","]","!","@","#","$","%","&","*","(",")","=","+","//","^","?","{","}",":",";",",","_",">","<","'","."]},t);this.option=o;const s=this;return this.each(e,function(t){if("text"==t.type&&t.dataset.mask){t.setAttribute("maxlength",t.dataset.mask.length),t.setAttribute("placeholder",t.dataset.mask),t.x_=0,t.prevValue="",t.addEventListener("keydown",s.onKeyDownMask),t.addEventListener("input",s.onInputMask,!1),t.ptrns=s.getPattern(t.dataset.mask,o);t.dataset.mask}})},getPatternChars(t){let e=[];return this.getPattern(t).forEach(o=>{e.push(t.substr(o,1))}),e},getPattern(t){let e=[];return t.split("").forEach((t,o)=>{-1!=this.option.dashItms.indexOf(t)&&e.push(o)}),e},md:t=>m.trust(marked(t)),onKeyDownMask(t,e=Mask){"Backspace"===t.key&&t.target.ptrns.includes(t.target.value.length-1)&&(t.target.value=t.target.value.slice(0,-1),this.x_--)},onInputMask(t,e=Mask){String.prototype.replaceAt=function(t,e){return this.substr(0,t)+e+this.substr(t+e.length)};let o=t.target.value;t.target.dataset.mask.replace(/[^a-zA-Z0-9 ]/g,"").match(/^[0-9]+$/);var s=e.getPatternChars(t.target.dataset.mask);let n=o.length;0===t.target.ptrns[0]&&0==this.x_?(t.target.value=s[0]+t.target.value.replace(/[^0-9/]/g,""),this.x_++):t.target.ptrns.includes(n)&&(t.target.value+=s[this.x_].replace(/[^0-9/]+./g,""),this.x_++)},each:(t,e)=>{t.element.forEach(o=>{e(o,t.element)})},extend:(t,e)=>{return{...t,...e}}};const Textarea={option:[],init:function(t,e){const o=this.extend({minHeight:45},t);this.option=o;const s=this;return this.each(e,function(t){if("textarea"===t.localName){if(t.attributes.autoresize)t.style.overflow="hidden",t.style.height=t.scrollHeight+"px",s.option.minHeightOffset=t.clientHeight,t.addEventListener("input",s.onKeyDown);else if(t.attributes.count){const e=document.createElement("span");e.className="badge background-light-primary textarea-count",e.innerHTML="0/"+t.attributes.count.nodeValue,t.parentNode.appendChild(e),t.addEventListener("input",s.inputCount)}}else console.error("This function is not supported on this html element!")})},inputCount:t=>{t.target.value;const e=t.target.parentNode.querySelector(".badge");e.innerHTML=t.target.value.length+"/"+t.target.attributes.count.nodeValue,t.target.value.length>=t.target.attributes.count.nodeValue?e.classList.add("text-danger"):e.classList.remove("text-danger")},onKeyDown:t=>{t.target.value.split(/\r|\r\n|\n/).length<=1?t.target.style.height="":(t.target.style.height="auto",t.target.style.height=t.target.scrollHeight+"px")},each:(t,e)=>{t.element.forEach(o=>{e(o,t.element)})},extend:(t,e)=>{return{...t,...e}}},Select={option:[],getDoublesElementsArr:[],init:function(t,e){const o=this.extend({minHeight:45},t);this.option=o;const s=this;let n=1;return this.each(e,function(t){if("select"===t.localName){const e="operaSelect-id-"+s.random(6)+"-"+n,o=document.createElement("span");t.setAttribute("data-operaselect-element-id",e),o.classList.add("operaSelect"),t.dataset.class&&o.classList.add(t.dataset.class),o.setAttribute("data-operaSelect-id",e),o.style.width="100%",t.dataset.multiple&&o.classList.add("display-flex","multiple-select"),o.innerHTML="<span class='operaSelect-selection form-select'>"+(t.dataset.multiple?"<ul class='no-list-style'></ul>":"")+(t.dataset.multiple?"<input type='text' class='operaSelect-transparentInput' placeholder='"+t.dataset.placeholder+"' />":"<span class='operaSelect-label'>"+t.dataset.placeholder+"</span>")+"<span class='operaSelect-arrow'></span></span>",t.parentNode.appendChild(o),t.classList.add("select-hidden"),o.addEventListener("click",s.handleClick,!1),t.dataset.multiple&&(o.childNodes[0].childNodes[1].addEventListener("keyup",t=>{const o=document.querySelectorAll("#"+e+" ul li");if(document.querySelectorAll("#"+e+" ul li.hide").length==o.length){if(!document.querySelectorAll("#"+e+" ul li#none")[0]){const t=document.createElement("li");t.id="none",t.setAttribute("role","alert"),t.setAttribute("disabled","true"),t.classList.add("operaSelect-item"),t.innerHTML=null==getSelectElement.dataset.noResults?"No results found":getSelectElement.dataset.noResults,o[0].parentNode.appendChild(t)}}else document.querySelectorAll("#"+e+" ul li#none")[0]&&document.querySelectorAll("#"+e+" ul li#none")[0].remove()}),o.childNodes[0].childNodes[1].addEventListener("input",t=>{const o=document.querySelectorAll("#"+e+" ul li");let s=t.target.value.toLowerCase();for(let t of o){-1==t.innerHTML.toLowerCase().indexOf(s)?t.classList.add("hide"):t.classList.remove("hide")}})),document.addEventListener("click",s.removeAllSelects),document.addEventListener("scroll",s.scrollPosition),n++}else console.error("This function is not supported on this html element!")})},removeAllSelects:t=>{t.target.matches(".operaSelect-selection")||t.target.matches(".operaSelect-label")||t.target.matches(".operaSelect-serch__field")||t.target.matches(".operaSelect-search")||t.target.matches(".operaSelect-item")||t.target.matches(".operaSelect-dropdown")||t.target.matches(".operaSelect-group")||t.target.matches(".operaSelect-transparentInput")||t.target.matches(".rmn-node")||document.querySelectorAll(".operaSelect-container").forEach(t=>{t.remove()})},handleClick:t=>{const e=t.currentTarget.dataset.operaselectId;const o=t.currentTarget.offsetLeft,s=t.currentTarget.offsetTop,n=t.currentTarget.offsetWidth,i=t.currentTarget.offsetHeight;if(document.querySelector("#"+e))return;const a=document.querySelector('[data-operaselect-element-id="'+e+'"]'),l=document.createElement("div");l.classList.add("operaSelect-container"),l.id=e,l.style.position="absolute",l.style.top=s+i+"px",l.style.left=o+"px",a.dataset.multiple&&(l.dataset.multiple=a.dataset.multiple);const r=document.createElement("div");if(r.classList.add("operaSelect-dropdown"),r.style.width=n+"px",l.appendChild(r),"true"==a.dataset.search){const t=document.createElement("div");t.classList.add("operaSelect-search"),t.innerHTML="<input type='text' class='operaSelect-serch__field' />",r.appendChild(t),t.addEventListener("keyup",t=>{const o=document.querySelectorAll("#"+e+" ul li");if(document.querySelectorAll("#"+e+" ul li.hide").length==o.length){if(!document.querySelectorAll("#"+e+" ul li#none")[0]){const t=document.createElement("li");t.id="none",t.setAttribute("role","alert"),t.setAttribute("disabled","true"),t.classList.add("operaSelect-item"),t.innerHTML=null==a.dataset.noResults?"No results found":a.dataset.noResults,o[0].parentNode.appendChild(t)}}else document.querySelectorAll("#"+e+" ul li#none")[0]&&document.querySelectorAll("#"+e+" ul li#none")[0].remove()}),t.addEventListener("input",t=>{const o=document.querySelectorAll("#"+e+" ul li");let s=t.target.value.toLowerCase();for(let t of o){-1==t.innerHTML.toLowerCase().indexOf(s)?t.classList.add("hide"):t.classList.remove("hide")}})}const c=document.createElement("ul");c.classList.add("operaSelect-list"),r.appendChild(c);for(let o=0;o<a.children.length;o++){const s=a.children[o];if(""!=s.value){const n=document.createElement("li");if(s.attributes.disabled?n.classList.add("operaSelect-group"):n.classList.add("operaSelect-item"),a.dataset.multiple){const t=document.querySelector('[data-operaselect-id="'+e+'"] ul');t.childNodes.forEach(t=>{t.dataset.nodeid==o&&n.classList.add("active")}),t.arrayMultipleSect=new Array}else t.currentTarget.dataset.selectedIndex==o&&n.classList.add("active");if(s.dataset.operaSelectImage?n.innerHTML='<div class="avatar mr-2"><img src="https://landkit.goodthemes.co/assets/img/avatars/avatar-1.jpg" alt="..." class="avatar-img rounded-circle"></div>'+s.innerText:n.innerText=s.innerText,s.attributes.disabled||(n.dataset.id=s.value),c.appendChild(n),!s.attributes.disabled){new Array;n.addEventListener("click",s=>{a.selectedIndex=o;for(let t=0;t<s.currentTarget.parentNode.children.length;t++)s.currentTarget.parentNode.children[t].classList.remove("active");a.dataset.multiple||(s.currentTarget.classList.add("active"),t.target.parentNode.dataset.selectedIndex=o),t.srcElement.children[0]?a.dataset.multiple?Select.getDoublesElements(t.target.childNodes[0].childNodes,o)?Select.removeDoublesElements(t.target.childNodes[0].childNodes,o):t.target.childNodes[0].innerHTML+="<li data-nodeID='"+o+"'><span class='badge badge-md background-grays-200 text-dark text-500'><a href='#"+e+"-remove' class='rmn-node' title='Remove item'>x</a> "+s.currentTarget.innerText+"</span></li>":t.srcElement.children[0].innerText=s.currentTarget.innerText:a.dataset.multiple?Select.getDoublesElements(t.target.parentNode.childNodes[0].childNodes,o)?Select.removeDoublesElements(t.target.parentNode.childNodes[0].childNodes,o):t.target.parentNode.childNodes[0].innerHTML+="<li data-nodeID='"+o+"'><span class='badge badge-md background-grays-200 text-dark text-500'><a href='#"+e+"-remove'  class='rmn-node' title='Remove item'>x</a> "+s.currentTarget.innerText+"</span></li>":t.srcElement.innerText=s.currentTarget.innerText,document.querySelectorAll(".rmn-node").forEach(t=>{t.addEventListener("click",t=>{t.preventDefault(),t.target.parentElement.parentElement.remove()})}),l.remove()})}}}setTimeout(()=>{Select.scrollPosition()},100),document.body.appendChild(l)},removeDoublesElements:(t,e)=>{t.forEach(t=>{t.dataset.nodeid==e&&(t.remove(),Select.getDoublesElementsArr.splice(e,1))})},getDoublesElements:(t,e)=>{let o=Select.getDoublesElementsArr;return 0==t.length&&(o=[]),t.forEach(t=>{t.dataset.nodeid==e&&o.push(parseInt(t.dataset.nodeid))}),Array.prototype.contains=function(t){for(var e=this.length;e--;)if(this[e]===t)return!0;return!1},console.log(o),o.contains(e)},scrollPosition:()=>{document.querySelectorAll(".operaSelect").forEach(t=>{window.innerWidth;const e=window.innerHeight,o=(window.scrollX,window.scrollY),s=(t.offsetLeft,t.offsetTop),n=(t.offsetWidth,t.offsetHeight);document.querySelectorAll(".operaSelect-container").forEach(t=>{if(t.children[0]){let i=o+e,a=s-t.children[0].offsetHeight;i<t.offsetTop+t.children[0].offsetHeight?t.style.top=a+"px":o>t.offsetTop&&(t.style.top=s+n+"px")}})})},random:(t=8)=>Math.random().toString(16).substr(2,t),each:(t,e)=>{t.element.forEach(o=>{e(o,t.element)})},extend:(t,e)=>{return{...t,...e}}},Modal={option:[],init:function(t,e){const o=this.extend({},t);this.option=o;const s=this;return this.each(e,function(t){const e=t.dataset.modalTarget;if(e){if(!e.includes(".")&&!e.includes("#"))return void console.error("Modal id not found!");t.addEventListener("click",s.modalShow)}})},modalShow:t=>{const e=document.querySelector(t.target.dataset.modalTarget);e.style.display="block",$("body").append('<div class="modal-backdrop fade"></div>',(t,o,s)=>{setTimeout(()=>{t.classList.add("show"),e.classList.add("show"),document.body.classList.add("modal-open"),document.body.style.overflow="hidden",document.body.style.paddingRight="17px"},1)});let o=e.dataset.ariaClosing||!0;"true"!=o&&1!=o||(window.onclick=function(t){t.target==e&&Modal.modalClose(e)}),$('.modal [data-modal-dismiss="'+t.target.dataset.modalTarget+'"]').on("click",function(t){t.preventDefault(),Modal.modalClose(e)})},modalClose:t=>{t.classList.remove("show"),document.querySelectorAll(".modal-backdrop").forEach(t=>{t.classList.remove("show")}),setTimeout(()=>{$(".modal-backdrop").remove(),t.style.display="none",document.body.classList.remove("modal-open"),document.body.style.overflow="",document.body.style.paddingRight=""},100)},each:(t,e)=>{t.element.forEach(o=>{e(o,t.element)})},extend:(t,e)=>{return{...t,...e}}}
